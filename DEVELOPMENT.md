# Development Guide

This guide covers everything you need to know to develop **clubrugby.ca** locally.

---

## Table of Contents

- [Prerequisites](#prerequisites)
- [Getting Started](#getting-started)
- [Data Management](#data-management)
- [Project Structure](#project-structure)
- [Development Workflow](#development-workflow)
- [Code Quality](#code-quality)
- [Optional Tips](#optional-tips)
- [Contributing](#contributing)

---

## Prerequisites

### Required Dependencies

Before you begin, ensure you have the following installed:

1. **Node.js** (v22 or higher)  
   - Download from [nodejs.org](https://nodejs.org/)  
   - Or use [nvm](https://github.com/nvm-sh/nvm) to manage versions

2. **npm** (v10 or higher)  
   - Comes with Node.js  
   - Used for managing project dependencies and running dev scripts

3. **Python** (v3.9 or higher)  
   - Required for the `clubrugby-data` scraper submodule  
   - Recommended to use [venv](https://docs.python.org/3/library/venv.html) or virtual environments to isolate dependencies

### Recommended Tools

- **nvm** (Node Version Manager) – easily switch Node versions
```bash
  nvm install 22
  nvm use 22
```

* **Python virtual environment** – isolate scraper dependencies

```bash
    python3 -m venv .venv
    source .venv/bin/activate  # macOS/Linux
    .venv\Scripts\activate     # Windows
```
* **VS Code** – recommended editor with Prettier extension for formatting

---

## Getting Started

### 1. Clone the Repository

```bash
git clone https://github.com/your-username/clubrugby.ca.git
cd clubrugby.ca
```

### 2. Initialize and Update Submodule

The project uses a Python scraper submodule to generate data:

```bash
git submodule update --init --recursive
```

This will create a `clubrugby-data/` directory containing the scraper.

### 3. Install Node Dependencies

```bash
npm install
```

Installs all frontend dependencies, including Astro, Vue, and Bootstrap.

### 4. Install Python Dependencies for Scraper

```bash
cd clubrugby-data
pip install -e .
```

This installs `requests` and registers the `clubrugby-scraper` script.

---

## Data Management

The "database" for **clubrugby.ca** consists of JSON files generated by the Python scraper:

```
data/
└── qc/
    └── 2025/
        ├── clubs.json
        ├── leagues.json
        ├── fixtures.json
        └── standings.json
```

### Running the Scraper

From the `clubrugby-data` directory:

```bash
clubrugby-scraper
```

* Generates or updates the JSON files for the given year/federation
* Make sure the output directory exists (`data/qc/2025/`)

### Adding New Federations or Years

* Create a folder structure: `data/{federation}/{year}/`
* Run the scraper configured for that federation/year
* The app will automatically read any JSON files in the correct path

### JSON Structure Overview

**Example: clubs.json**

```json
[
  { "id": 101, "name": "Montreal Barbarians", "logo_url": "/logos/montreal.png" }
]
```

**Example: fixtures.json**

```json
[
  { "league_id": 1, "home_id": 101, "away_id": 102, "date": "2025-03-15", "time": "14:00" }
]
```

**Example: standings.json**

```json
[
  { "league_id": 1, "team_id": 101, "pld": 5, "w": 4, "l": 1, "pts": 12 }
]
```

---

## Project Structure

```
clubrugby.ca/
├── public/                  # Static assets (images, logos, favicons)
├── src/
│   ├── components/          # Vue components
│   ├── layouts/             # Astro layouts
│   ├── pages/               # Astro pages
│   └── styles/              # CSS/Bootstrap overrides
├── data/                    # JSON data generated by scraper
├── clubrugby-data/          # Python scraper submodule
├── package.json
├── astro.config.mjs
└── tsconfig.json
```

---

## Development Workflow

### Running the Development Server

Start the Astro dev server:

```bash
npm run dev
```

* Host: `http://localhost:5173`
* Hot Module Replacement (HMR) is enabled
* Vue components update instantly on file changes

### Development Tips

* **Vue Router:** Routes are defined in `src/pages` using file-based routing
* **JSON Data:** You can import JSON files directly in Astro/Vue components

  ```ts
  import clubs from '../../data/qc/2025/clubs.json';
  ```
* **Bootstrap Utilities:** Use flexbox, grid, spacing, and components classes
* **Date Handling:** Use `date-fns` for formatting and comparing dates
* **Calendar Links:** Use `calendar-link` to generate event links for Google/Outlook/etc.

---

## Code Quality

### Prettier Formatting

**Prettier** ensures consistent formatting:

```bash
# Format all files
npx prettier --write .

# Formart specific files
npx prettier --write "src/**/*.{js,ts,vue,jsx,tsx,json,css,scss,md}"

# Check formatting without changing files
npx prettier --check .
```

**Editor Integration:**

* VS Code Prettier extension
* Enable "Format on Save"

---

## Optional Tips

* **Adding a New Year or Federation:**
  Simply add `data/{federation}/{year}/` and run the scraper
* **Refreshing Data:**
  Re-run `clubrugby-scraper` anytime to update JSON files
* **Debugging Vue Components:**
  Use Vue DevTools in the browser
* **Bootstrap Layouts:**
  Use container, row, col classes for responsive layouts

---

## Contributing

When contributing:

1. Format your code with Prettier
2. Ensure JSON data is correctly structured
3. Test the app with `npm run dev`
4. Follow existing patterns for components and pages
5. Update this document if workflows or paths change